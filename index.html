<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Snowglobe Collection</title>
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
    #map { width: 100%; height: 80vh; }
    #stats { padding: 1em; background: #f9f9f9; }
    h1, h2 { text-align: center; }
  </style>
</head>
<body>
  <h1>My Snowglobe Collection</h1>
  <div id="map"></div>
  <div id="stats">
    <h2>Collection Statistics</h2>
    <div id="stats-content"></div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Leaflet Heatmap Plugin -->
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
  <script>
    // Example dataset for your snowglobes.
    // Each item contains: latitude, longitude, country, and description.
    const snowglobes = [
      { lat: 51.5074, lng: -0.1278, country: "United Kingdom", description: "London Snowglobe - Classic design" },
      { lat: 48.8566, lng: 2.3522, country: "France", description: "Paris Snowglobe - Eiffel Tower" },
      { lat: 40.7128, lng: -74.0060, country: "USA", description: "New York Snowglobe - Cityscape" },
      { lat: 35.6895, lng: 139.6917, country: "Japan", description: "Tokyo Snowglobe - Neon lights" },
      // Add more data points as needed...
    ];

    // Initialize the map
    const map = L.map('map').setView([20, 0], 2);  // world view

    // Add OpenStreetMap tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // Create a layer group for markers (data points)
    const markersLayer = L.layerGroup().addTo(map);

    // Array to hold heatmap points (each point as [lat, lng, intensity])
    const heatPoints = [];

    // Create markers with tooltips and add heatmap points
    snowglobes.forEach(item => {
      const marker = L.marker([item.lat, item.lng]).addTo(markersLayer);
      marker.bindPopup(`<strong>${item.country}</strong><br>${item.description}`);
      
      // Adding the point for the heatmap with an intensity of 0.5 (adjust as needed)
      heatPoints.push([item.lat, item.lng, 0.5]);
    });

    // Add heatmap layer
    const heat = L.heatLayer(heatPoints, { 
      radius: 25,
      blur: 15,
      maxZoom: 5,
    }).addTo(map);

    // Calculate simple statistics
    function calculateStats(data) {
      const stats = {
        total: data.length,
        byCountry: {}
      };

      data.forEach(item => {
        stats.byCountry[item.country] = (stats.byCountry[item.country] || 0) + 1;
      });
      
      return stats;
    }

    // Render the statistics on the page
    function renderStats(stats) {
      const container = document.getElementById('stats-content');
      container.innerHTML = `<p><strong>Total Snowglobes:</strong> ${stats.total}</p>`;
      
      let list = '<ul>';
      for (const country in stats.byCountry) {
        list += `<li>${country}: ${stats.byCountry[country]}</li>`;
      }
      list += '</ul>';
      
      container.innerHTML += list;
    }

    const stats = calculateStats(snowglobes);
    renderStats(stats);
  </script>
</body>
</html>
